Index: app/src/main/java/com/example/fitrecipes/Models/ImagesModel.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.fitrecipes.Models;\r\n\r\nimport java.io.Serializable;\r\n\r\npublic class ImagesModel implements Serializable {\r\n    int id,recipeId;\r\n    String image;\r\n\r\n    public ImagesModel(String image) {\r\n        this.image = image;\r\n    }\r\n\r\n\r\n    public ImagesModel() {\r\n    }\r\n\r\n    public int getId() {\r\n        return id;\r\n    }\r\n\r\n    public void setId(int id) {\r\n        this.id = id;\r\n    }\r\n\r\n    public int getRecipeId() {\r\n        return recipeId;\r\n    }\r\n\r\n    public void setRecipeId(int recipeId) {\r\n        this.recipeId = recipeId;\r\n    }\r\n\r\n    public String getImage() {\r\n        return image;\r\n    }\r\n\r\n    public void setImage(String image) {\r\n        this.image = image;\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/fitrecipes/Models/ImagesModel.java b/app/src/main/java/com/example/fitrecipes/Models/ImagesModel.java
--- a/app/src/main/java/com/example/fitrecipes/Models/ImagesModel.java	(revision d6d0cf8e86dd3fe334925b57cc33952e164daaf4)
+++ b/app/src/main/java/com/example/fitrecipes/Models/ImagesModel.java	(date 1650464255514)
@@ -3,38 +3,31 @@
 import java.io.Serializable;
 
 public class ImagesModel implements Serializable {
-    int id,recipeId;
-    String image;
 
-    public ImagesModel(String image) {
-        this.image = image;
-    }
-
+    String id;
+    String userImage;
 
     public ImagesModel() {
     }
 
-    public int getId() {
+    public ImagesModel(String id, String userImage) {
+        this.id = id;
+        this.userImage = userImage;
+    }
+
+    public String getId() {
         return id;
     }
 
-    public void setId(int id) {
+    public void setId(String id) {
         this.id = id;
     }
 
-    public int getRecipeId() {
-        return recipeId;
-    }
-
-    public void setRecipeId(int recipeId) {
-        this.recipeId = recipeId;
+    public String getUserImage() {
+        return userImage;
     }
 
-    public String getImage() {
-        return image;
+    public void setUserImage(String userImage) {
+        this.userImage = userImage;
     }
-
-    public void setImage(String image) {
-        this.image = image;
-    }
-}
+}
\ No newline at end of file
Index: app/src/main/res/layout/recipesrvlayout.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.cardview.widget.CardView xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"wrap_content\">\r\n\r\n    <RelativeLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:padding=\"15dp\">\r\n\r\n        <de.hdodenhof.circleimageview.CircleImageView\r\n            android:id=\"@+id/img1\"\r\n            android:layout_width=\"80dp\"\r\n            android:layout_height=\"80dp\"\r\n            android:layout_centerVertical=\"true\"\r\n            android:src=\"@mipmap/ic_launcher\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/tv_Recipe_name\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginLeft=\"10dp\"\r\n            android:layout_toRightOf=\"@id/img1\"\r\n            android:text=\"Recipe Name\"\r\n            android:textColor=\"#000\"\r\n            android:textSize=\"25sp\"\r\n            android:textStyle=\"bold\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/tv_cook_time\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/tv_Recipe_name\"\r\n            android:layout_marginLeft=\"10dp\"\r\n            android:layout_toRightOf=\"@id/img1\"\r\n            android:text=\"Recipe Cook Time\"\r\n            android:textColor=\"#000\"\r\n            android:textSize=\"25sp\" />\r\n\r\n\r\n        <TextView\r\n            android:id=\"@+id/tv_People\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/tv_cook_time\"\r\n            android:layout_marginLeft=\"10dp\"\r\n            android:layout_toRightOf=\"@id/img1\"\r\n            android:text=\"No. of Serving People\"\r\n            android:textColor=\"#000\"\r\n            android:textSize=\"25sp\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/tv_Recipe_Ingredients\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/tv_People\"\r\n            android:layout_marginLeft=\"10dp\"\r\n            android:layout_toRightOf=\"@id/img1\"\r\n            android:text=\"Recipe Ingredients\"\r\n            android:textColor=\"#000\"\r\n            android:textSize=\"25sp\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/tv_Recipe_Description\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/tv_Recipe_Ingredients\"\r\n            android:layout_marginLeft=\"10dp\"\r\n            android:layout_toRightOf=\"@id/img1\"\r\n            android:text=\"Recipe Description\"\r\n            android:textColor=\"#000\"\r\n            android:textSize=\"25sp\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/tv_Recipe_Instructions\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/tv_Recipe_Description\"\r\n            android:layout_marginLeft=\"10dp\"\r\n            android:layout_toRightOf=\"@id/img1\"\r\n            android:text=\"Recipe Instruction\"\r\n            android:textColor=\"#000\"\r\n            android:textSize=\"25sp\" />\r\n\r\n\r\n    </RelativeLayout>\r\n</androidx.cardview.widget.CardView>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/recipesrvlayout.xml b/app/src/main/res/layout/recipesrvlayout.xml
--- a/app/src/main/res/layout/recipesrvlayout.xml	(revision d6d0cf8e86dd3fe334925b57cc33952e164daaf4)
+++ b/app/src/main/res/layout/recipesrvlayout.xml	(date 1650467211439)
@@ -1,7 +1,11 @@
 <?xml version="1.0" encoding="utf-8"?>
 <androidx.cardview.widget.CardView xmlns:android="http://schemas.android.com/apk/res/android"
     android:layout_width="match_parent"
-    android:layout_height="wrap_content">
+    android:layout_height="wrap_content"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:padding="10dp"
+    app:cardCornerRadius="16dp"
+    android:backgroundTint="@color/teal_700">
 
     <RelativeLayout
         android:layout_width="match_parent"
@@ -12,15 +16,15 @@
             android:id="@+id/img1"
             android:layout_width="80dp"
             android:layout_height="80dp"
-            android:layout_centerVertical="true"
+            android:layout_centerHorizontal="true"
             android:src="@mipmap/ic_launcher" />
 
         <TextView
             android:id="@+id/tv_Recipe_name"
-            android:layout_width="match_parent"
+            android:layout_width="wrap_content"
             android:layout_height="wrap_content"
-            android:layout_marginLeft="10dp"
-            android:layout_toRightOf="@id/img1"
+            android:layout_centerHorizontal="true"
+            android:layout_below="@id/img1"
             android:text="Recipe Name"
             android:textColor="#000"
             android:textSize="25sp"
@@ -31,8 +35,6 @@
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:layout_below="@id/tv_Recipe_name"
-            android:layout_marginLeft="10dp"
-            android:layout_toRightOf="@id/img1"
             android:text="Recipe Cook Time"
             android:textColor="#000"
             android:textSize="25sp" />
@@ -43,8 +45,6 @@
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:layout_below="@id/tv_cook_time"
-            android:layout_marginLeft="10dp"
-            android:layout_toRightOf="@id/img1"
             android:text="No. of Serving People"
             android:textColor="#000"
             android:textSize="25sp" />
@@ -54,8 +54,6 @@
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:layout_below="@id/tv_People"
-            android:layout_marginLeft="10dp"
-            android:layout_toRightOf="@id/img1"
             android:text="Recipe Ingredients"
             android:textColor="#000"
             android:textSize="25sp" />
@@ -65,8 +63,6 @@
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:layout_below="@id/tv_Recipe_Ingredients"
-            android:layout_marginLeft="10dp"
-            android:layout_toRightOf="@id/img1"
             android:text="Recipe Description"
             android:textColor="#000"
             android:textSize="25sp" />
@@ -76,8 +72,6 @@
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:layout_below="@id/tv_Recipe_Description"
-            android:layout_marginLeft="10dp"
-            android:layout_toRightOf="@id/img1"
             android:text="Recipe Instruction"
             android:textColor="#000"
             android:textSize="25sp" />
Index: app/src/main/java/com/example/fitrecipes/Activities/HomeActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.fitrecipes.Activities;\r\n\r\n\r\nimport android.app.ProgressDialog;\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.view.View;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.recyclerview.widget.GridLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.daimajia.slider.library.Animations.DescriptionAnimation;\r\nimport com.daimajia.slider.library.SliderLayout;\r\nimport com.example.fitrecipes.Models.RecipeAdapter;\r\nimport com.example.fitrecipes.Models.RecipeModel;\r\nimport com.example.fitrecipes.R;\r\nimport com.firebase.ui.database.FirebaseRecyclerOptions;\r\nimport com.google.android.gms.tasks.OnFailureListener;\r\nimport com.google.android.gms.tasks.OnSuccessListener;\r\nimport com.google.android.material.snackbar.Snackbar;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.database.DataSnapshot;\r\nimport com.google.firebase.database.DatabaseError;\r\nimport com.google.firebase.database.DatabaseReference;\r\nimport com.google.firebase.database.FirebaseDatabase;\r\nimport com.google.firebase.database.ValueEventListener;\r\nimport com.google.firebase.storage.FirebaseStorage;\r\nimport com.google.firebase.storage.OnProgressListener;\r\nimport com.google.firebase.storage.StorageReference;\r\nimport com.google.firebase.storage.StorageTask;\r\nimport com.google.firebase.storage.UploadTask;\r\nimport com.squareup.picasso.Picasso;\r\nimport com.yarolegovich.slidingrootnav.SlidingRootNav;\r\nimport com.yarolegovich.slidingrootnav.SlidingRootNavBuilder;\r\nimport com.example.fitrecipes.Models.MyRecyclerViewAdapter;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\nimport java.util.UUID;\r\n\r\npublic class HomeActivity extends AppCompatActivity {\r\n    private RecipeModel recipeModel;\r\n    private SliderLayout sliderLayout;\r\n    private RecyclerView recyclerView;\r\n    ArrayList<RecipeModel> recipeModelArrayList;\r\n    ArrayList<RecipeModel> sliderRecipeList;\r\n    SlidingRootNav slidingRootNav;\r\n    TextView name, phone, emailAddress, tv_changePass;\r\n    ImageView iv_pic, iv_edPic;\r\n    RecipeAdapter recipeAdapter;\r\n    public Uri imageUri;\r\n    private FirebaseStorage storage;\r\n    private StorageReference storageReference;\r\n    private StorageTask uploadTask;\r\n    Context context;\r\n    private EditText et_search;\r\n    private FirebaseAuth mAuth;\r\n    private FirebaseDatabase firebaseDatabase;\r\n    private DatabaseReference databaseReference, databaseReference3;\r\n    private static final String USERS = \"users\";\r\n    private String myUri = \"\";\r\n    private String uuid = \"\";\r\n    private String USERID = \"\";\r\n    ArrayList<RecipeModel> recipeModelArrayList2;\r\n    MyRecyclerViewAdapter adapter;\r\n\r\n    @Override\r\n    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.home_activity);\r\n//        databaseReference3 = FirebaseDatabase.getInstance().getReference();\r\n\r\n        slidingRootNav = new SlidingRootNavBuilder(this)\r\n                .withMenuLayout(R.layout.activity_drawer)\r\n                .withMenuOpened(false)\r\n                .inject();\r\n\r\n        context = this;\r\n        uuid = LoginActivity.UUID;\r\n        USERID = getIntent().getExtras().getString(\"uuid\");\r\n        TextView name1 = findViewById(R.id.name);\r\n        et_search = findViewById(R.id.et_search);\r\n        sliderLayout = findViewById(R.id.slider);\r\n        sliderLayout.setPresetTransformer(SliderLayout.Transformer.Accordion);\r\n        sliderLayout.setPresetIndicator(SliderLayout.PresetIndicators.Center_Bottom);\r\n        sliderLayout.setCustomAnimation(new DescriptionAnimation());\r\n        sliderLayout.setDuration(3333);\r\n        recyclerView = findViewById(R.id.recyclerview);\r\n        recipeModelArrayList = new ArrayList();\r\n        recipeModelArrayList2 = new ArrayList();\r\n        sliderRecipeList = new ArrayList();\r\n\r\n        recyclerView.setLayoutManager(new GridLayoutManager(context, 1));\r\n\r\n        List<String> data = new ArrayList<>();\r\n\r\n        List<RecipeModel> mData = new ArrayList<>();\r\n        databaseReference3 = FirebaseDatabase.getInstance().getReference().child(\"recipes\");\r\n\r\n        ValueEventListener postListener = new ValueEventListener() {\r\n            @Override\r\n            public void onDataChange(DataSnapshot dataSnapshot) {\r\n                // Get Post object and use the values to update the UI\r\n                RecipeModel post = dataSnapshot.getValue(RecipeModel.class);\r\n                mData.add(post);\r\n                adapter = new MyRecyclerViewAdapter(HomeActivity.this,mData);\r\n                recyclerView.setAdapter(adapter);\r\n            }\r\n\r\n            @Override\r\n            public void onCancelled(DatabaseError databaseError) {\r\n                // Getting Post failed, log a message\r\n                Log.w(\"loadPost:onCancelled\", databaseError.toException());\r\n            }\r\n        };\r\n        databaseReference3.addValueEventListener(postListener);\r\n\r\n        Intent intent = getIntent();\r\n        String email = intent.getStringExtra(\"email\");\r\n        mAuth = FirebaseAuth.getInstance();\r\n        firebaseDatabase = FirebaseDatabase.getInstance();\r\n        databaseReference = firebaseDatabase.getReference(USERS);\r\n        setListeners();\r\n        init();\r\n        databaseReference.addValueEventListener(new ValueEventListener() {\r\n            @Override\r\n            public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                for (DataSnapshot dataSnapshot : snapshot.getChildren()) {\r\n//                    RecipeModel recipeModel = dataSnapshot.getValue(RecipeModel.class);\r\n//                    recipeModelArrayList2.add(recipeModel);\r\n                }\r\n            }\r\n\r\n            @Override\r\n            public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n            }\r\n        });\r\n        //things added stop\r\n\r\n        StorageReference riversRef = storageReference.child(\"M1.jpg\");\r\n        riversRef.getDownloadUrl().addOnSuccessListener(new OnSuccessListener<Uri>() {\r\n            @Override\r\n            public void onSuccess(Uri uri) {\r\n                Picasso.get().load(imageUri).into(iv_pic);\r\n\r\n            }\r\n        });\r\n        databaseReference.addValueEventListener(new ValueEventListener() {\r\n            @Override\r\n            public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                for (DataSnapshot ds : snapshot.getChildren()) {\r\n                    if (uuid.equals(ds.getKey())) {\r\n                        emailAddress.setText(ds.child(\"email\").getValue(String.class));\r\n                        name.setText(ds.child(\"name\").getValue(String.class));\r\n                        phone.setText(ds.child(\"phone\").getValue(String.class));\r\n                        Glide.with(iv_pic).load(\"https://firebasestorage.googleapis.com/v0/b/fitrecipes-db5ec.appspot.com/o/1650384443655.jpg?alt=media&token=8c2f844f-0b5c-49ed-88de-8b2d1b1e47a9\").into(iv_pic);\r\n\r\n                    }\r\n                }\r\n            }\r\n\r\n            @Override\r\n            public void onCancelled(@NonNull DatabaseError error) {\r\n            }\r\n        });\r\n    }\r\n\r\n    private void setListeners() {\r\n        findViewById(R.id.tv_logout).setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                signOutUser();\r\n            }\r\n        });\r\n        findViewById(R.id.fab).setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                startActivity(new Intent(context, AddRecipeActivity.class).putExtra(\"uuid\", USERID));\r\n            }\r\n        });\r\n        findViewById(R.id.iv_menu).setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                slidingRootNav.openMenu();\r\n            }\r\n        });\r\n        findViewById(R.id.btn_my_recipes).setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                startActivity(new Intent(context, MyRecipesActivity.class));\r\n            }\r\n        });\r\n\r\n        findViewById(R.id.btn_edit_profile).setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                startActivity(new Intent(context, ProfileActivity.class));\r\n            }\r\n        });\r\n        findViewById(R.id.iv_edit).setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                choosePicture();\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    private void init() {\r\n\r\n        name = findViewById(R.id.tv_name);\r\n        emailAddress = findViewById(R.id.tv_email);\r\n        phone = findViewById(R.id.tv_phone);\r\n        iv_pic = findViewById(R.id.iv_profilePic);\r\n        storage = FirebaseStorage.getInstance();\r\n        iv_edPic = findViewById(R.id.iv_edit);\r\n        storageReference = storage.getReference();\r\n\r\n    }\r\n\r\n    private void choosePicture() {\r\n        Intent intent = new Intent();\r\n        intent.setType(\"image/*\");\r\n        intent.setAction(Intent.ACTION_GET_CONTENT);\r\n        startActivityForResult(intent, 1);\r\n    }\r\n\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        if (requestCode == 1 && resultCode == RESULT_OK && data != null && data.getData() != null) {\r\n            imageUri = data.getData();\r\n            iv_pic.setImageURI(imageUri);\r\n            uploadPicture();\r\n        }\r\n    }\r\n\r\n    private void uploadPicture() {\r\n        final ProgressDialog pd = new ProgressDialog(this);\r\n        pd.setTitle(\"Uploading Image.....\");\r\n        pd.show();\r\n        final String randomKey = UUID.randomUUID().toString();\r\n        StorageReference riversRef = storageReference.child(\"images/\" + randomKey);\r\n\r\n        try {\r\n\r\n            riversRef.putFile(imageUri)\r\n                    .addOnSuccessListener(new OnSuccessListener<UploadTask.TaskSnapshot>() {\r\n                        @Override\r\n                        public void onSuccess(UploadTask.TaskSnapshot taskSnapshot) {\r\n                            pd.dismiss();\r\n                            Snackbar.make(findViewById(android.R.id.content), \"Image Uploaded.\", Snackbar.LENGTH_LONG).show();\r\n                            Glide.with(iv_pic).load(\"https://firebasestorage.googleapis.com/v0/b/fitrecipes-db5ec.appspot.com/o/1650384443655.jpg?alt=media&token=8c2f844f-0b5c-49ed-88de-8b2d1b1e47a9\").into(iv_pic);\r\n                        }\r\n                    })\r\n                    .addOnFailureListener(new OnFailureListener() {\r\n                        @Override\r\n                        public void onFailure(@NonNull Exception e) {\r\n                            pd.dismiss();\r\n                            Toast.makeText(context, \"Failed To Upload\", Toast.LENGTH_SHORT).show();\r\n                        }\r\n                    })\r\n                    .addOnProgressListener(new OnProgressListener<UploadTask.TaskSnapshot>() {\r\n                        @Override\r\n                        public void onProgress(@NonNull UploadTask.TaskSnapshot snapshot) {\r\n                            double progressPercent = (100.00 * snapshot.getBytesTransferred() / snapshot.getTotalByteCount());\r\n                            pd.setMessage(\" Progress:\" + (int) progressPercent + \"%\");\r\n\r\n                        }\r\n                    });\r\n        } catch (Exception e) {\r\n\r\n        }\r\n    }\r\n\r\n    private void signOutUser() {\r\n        mAuth.signOut();\r\n        Intent intent = new Intent(context, LoginActivity.class);\r\n        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);\r\n        startActivity(intent);\r\n        finish();\r\n    }\r\n\r\n    @Override\r\n    public void onResume() {\r\n        super.onResume();\r\n        uuid = LoginActivity.UUID;\r\n    }\r\n\r\n\r\n\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/fitrecipes/Activities/HomeActivity.java b/app/src/main/java/com/example/fitrecipes/Activities/HomeActivity.java
--- a/app/src/main/java/com/example/fitrecipes/Activities/HomeActivity.java	(revision d6d0cf8e86dd3fe334925b57cc33952e164daaf4)
+++ b/app/src/main/java/com/example/fitrecipes/Activities/HomeActivity.java	(date 1650468155713)
@@ -2,12 +2,14 @@
 
 
 import android.app.ProgressDialog;
+import android.content.ContentResolver;
 import android.content.Context;
 import android.content.Intent;
 import android.net.Uri;
 import android.os.Bundle;
 import android.util.Log;
 import android.view.View;
+import android.webkit.MimeTypeMap;
 import android.widget.EditText;
 import android.widget.ImageView;
 import android.widget.TextView;
@@ -24,10 +26,12 @@
 import com.daimajia.slider.library.SliderLayout;
 import com.example.fitrecipes.Models.RecipeAdapter;
 import com.example.fitrecipes.Models.RecipeModel;
+import com.example.fitrecipes.Models.ImagesModel;
 import com.example.fitrecipes.R;
 import com.firebase.ui.database.FirebaseRecyclerOptions;
 import com.google.android.gms.tasks.OnFailureListener;
 import com.google.android.gms.tasks.OnSuccessListener;
+import com.google.android.gms.tasks.Task;
 import com.google.android.material.snackbar.Snackbar;
 import com.google.firebase.auth.FirebaseAuth;
 import com.google.firebase.database.DataSnapshot;
@@ -79,7 +83,7 @@
     protected void onCreate(@Nullable Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.home_activity);
-//        databaseReference3 = FirebaseDatabase.getInstance().getReference();
+        databaseReference3 = FirebaseDatabase.getInstance().getReference();
 
         slidingRootNav = new SlidingRootNavBuilder(this)
                 .withMenuLayout(R.layout.activity_drawer)
@@ -149,15 +153,18 @@
         });
         //things added stop
 
-        StorageReference riversRef = storageReference.child("M1.jpg");
+        StorageReference riversRef = storageReference.child("images");
         riversRef.getDownloadUrl().addOnSuccessListener(new OnSuccessListener<Uri>() {
+            final String[] photoLink = {""};
             @Override
             public void onSuccess(Uri uri) {
-                Picasso.get().load(imageUri).into(iv_pic);
+                Glide.with(iv_pic).load(photoLink[0]).into(iv_pic);
+
 
             }
         });
         databaseReference.addValueEventListener(new ValueEventListener() {
+            final String[] photoLink = {""};
             @Override
             public void onDataChange(@NonNull DataSnapshot snapshot) {
                 for (DataSnapshot ds : snapshot.getChildren()) {
@@ -165,7 +172,8 @@
                         emailAddress.setText(ds.child("email").getValue(String.class));
                         name.setText(ds.child("name").getValue(String.class));
                         phone.setText(ds.child("phone").getValue(String.class));
-                        Glide.with(iv_pic).load("https://firebasestorage.googleapis.com/v0/b/fitrecipes-db5ec.appspot.com/o/1650384443655.jpg?alt=media&token=8c2f844f-0b5c-49ed-88de-8b2d1b1e47a9").into(iv_pic);
+                        Glide.with(iv_pic).load(photoLink[0]).into(iv_pic);
+
 
                     }
                 }
@@ -246,42 +254,64 @@
             uploadPicture();
         }
     }
+    public String GetFileExtension(Uri uri) {
+        ContentResolver contentResolver = getContentResolver();
+        MimeTypeMap mimeTypeMap = MimeTypeMap.getSingleton();
+        return mimeTypeMap.getExtensionFromMimeType(contentResolver.getType(uri));
+    }
+
 
     private void uploadPicture() {
-        final ProgressDialog pd = new ProgressDialog(this);
-        pd.setTitle("Uploading Image.....");
-        pd.show();
-        final String randomKey = UUID.randomUUID().toString();
-        StorageReference riversRef = storageReference.child("images/" + randomKey);
-
-        try {
-
-            riversRef.putFile(imageUri)
-                    .addOnSuccessListener(new OnSuccessListener<UploadTask.TaskSnapshot>() {
-                        @Override
-                        public void onSuccess(UploadTask.TaskSnapshot taskSnapshot) {
-                            pd.dismiss();
-                            Snackbar.make(findViewById(android.R.id.content), "Image Uploaded.", Snackbar.LENGTH_LONG).show();
-                            Glide.with(iv_pic).load("https://firebasestorage.googleapis.com/v0/b/fitrecipes-db5ec.appspot.com/o/1650384443655.jpg?alt=media&token=8c2f844f-0b5c-49ed-88de-8b2d1b1e47a9").into(iv_pic);
-                        }
-                    })
-                    .addOnFailureListener(new OnFailureListener() {
-                        @Override
-                        public void onFailure(@NonNull Exception e) {
-                            pd.dismiss();
-                            Toast.makeText(context, "Failed To Upload", Toast.LENGTH_SHORT).show();
-                        }
-                    })
-                    .addOnProgressListener(new OnProgressListener<UploadTask.TaskSnapshot>() {
-                        @Override
-                        public void onProgress(@NonNull UploadTask.TaskSnapshot snapshot) {
-                            double progressPercent = (100.00 * snapshot.getBytesTransferred() / snapshot.getTotalByteCount());
-                            pd.setMessage(" Progress:" + (int) progressPercent + "%");
+        if (imageUri != null) {
+            final ProgressDialog pd = new ProgressDialog(this);
+            pd.setTitle("Uploading Image.....");
+            pd.show();
+           /* final String randomKey = UUID.randomUUID().toString();
+            StorageReference riversRef = storageReference.child("images/" + randomKey);
+*/
+            try {
+                 storageReference = FirebaseStorage.getInstance().getReference().child(System.currentTimeMillis() + "." + GetFileExtension(imageUri));
+                storageReference.putFile(imageUri)
+                        .addOnSuccessListener(new OnSuccessListener<UploadTask.TaskSnapshot>() {
+                            @Override
+                            public void onSuccess(UploadTask.TaskSnapshot taskSnapshot) {
+                                pd.dismiss();
+                                final String[] photoLink = {""};
+                                Task<Uri> task = taskSnapshot.getMetadata().getReference().getDownloadUrl();
+                                task.addOnSuccessListener(new OnSuccessListener<Uri>() {
+                                    @Override
+                                    public void onSuccess(Uri uri) {
+                                        photoLink[0] = uri.toString();
+                                        Glide.with(iv_pic).load(photoLink[0]).into(iv_pic);
+                                        Snackbar.make(findViewById(android.R.id.content), "Image Uploaded.", Snackbar.LENGTH_LONG).show();
+                                        ImagesModel imageUploadInfo = new ImagesModel(uuid,
+                                                photoLink[0]);
+                                        databaseReference.child("recipes").setValue(imageUploadInfo);
+                                    }
+                                });
+                            }
+                        })
+                        .addOnFailureListener(new OnFailureListener() {
+                            @Override
+                            public void onFailure(@NonNull Exception e) {
+                                pd.dismiss();
+                                Toast.makeText(context, "Failed To Upload", Toast.LENGTH_SHORT).show();
+                            }
+                        })
+                        .addOnProgressListener(new OnProgressListener<UploadTask.TaskSnapshot>() {
+                            @Override
+                            public void onProgress(@NonNull UploadTask.TaskSnapshot snapshot) {
+                                double progressPercent = (100.00 * snapshot.getBytesTransferred() / snapshot.getTotalByteCount());
+                                pd.setMessage(" Progress:" + (int) progressPercent + "%");
 
-                        }
-                    });
-        } catch (Exception e) {
+                            }
+                        });
+            } catch (Exception e) {
 
+            }
+        }else {
+            Toast.makeText(HomeActivity.this, "Please Select Image", Toast.LENGTH_LONG).show();
+
         }
     }
 
